!function(){"use strict";var e=class{constructor(e){this._element=document.querySelector(e),this._buttonClose=this._element.querySelector(".popup__button-close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._element.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._element.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._element.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close()})),this._buttonClose.addEventListener("click",(()=>{this.close()}))}},t=class extends e{constructor(e,t,n){let{submitButtonLabel:s,submitButtonAltLabel:i}=t;super(e),this._handleFormSubmit=n,this._form=this._element.querySelector(".popup__form"),this._buttonSubmit=this._form.querySelector(".form__button-submit"),this._buttonSubmitLabel=s,this._buttonSubmitAltLabel=i,this._buttonSubmit.textContent=s}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setSubmitHandler(e){this._handleFormSubmit=e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues(),this)})),super.setEventListeners()}showLoading(){this._buttonSubmit.textContent=this._buttonSubmitAltLabel}hideLoading(){this._buttonSubmit.textContent=this._buttonSubmitLabel}close(){super.close(),this._form.reset()}};const n=e=>e.ok?e.json():Promise.reject("".concat(e.status," ").concat(e.statusText));const s="Save",i="Saving...",r=document.querySelector(".popup__container_content_edit-profile").querySelector(".form"),o=r.querySelector(".form__input_type_name"),a=r.querySelector(".form__input_type_job"),l=document.querySelector(".popup_content_edit-avatar").querySelector(".form"),_=(l.querySelector(".form__input_type_link"),document.querySelector(".popup__container_content_add-card").querySelector(".form"));let c="";const h=new class{constructor(e){let{serverUrl:t,groupId:n,token:s}=e;this._serverUrl=t,this._groupId=n,this._token=s}setup(){this._mainUrl="".concat(this._serverUrl,"/v1/").concat(this._groupId),this._headers={authorization:this._token,"Content-Type":"application/json"}}addNewCard(e){let{name:t,link:s}=e;return fetch("".concat(this._mainUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(n)}getUserData(){return fetch("".concat(this._mainUrl,"/users/me"),{headers:this._headers}).then(n)}removeLike(e){return fetch("".concat(this._mainUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(n)}addLike(e){return fetch("".concat(this._mainUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(n)}setUserData(e){let{name:t,about:s}=e;return fetch("".concat(this._mainUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(n)}setUserAvatar(e){return fetch("".concat(this._mainUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(n)}removeCard(e){return fetch("".concat(this._mainUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(n)}getInitialCardsData(){return fetch("".concat(this._mainUrl,"/cards"),{headers:this._headers}).then(n)}getInitialData(){return Promise.all([this.getUserData(),this.getInitialCardsData()])}}({serverUrl:"https://around.nomoreparties.co",groupId:"group-12",token:"652541db-3ac9-4c6c-9895-39ab2ae4c9f3"}),u=document.querySelector(".profile"),m=u.querySelector(".profile-info__button-edit"),d=u.querySelector(".profile__button-add"),p=u.querySelector(".avatar"),b=new class{constructor(e){let{nameSelector:t,jobSelector:n,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(n),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,job:n,avatar:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=n,this._avatarElement.src=s}}({nameSelector:".profile-info__name",jobSelector:".profile-info__job",avatarSelector:".avatar"}),L=new class extends e{constructor(e){super(e),this._image=this._element.querySelector(".popup__image"),this._imageTitle=this._element.querySelector(".popup__image-title")}open(e,t){this._imageTitle.textContent=e,this._image.alt=e,this._image.src=t,super.open()}}(".popup_content_image"),v={},g=new t(".popup_content_confirmation",{submitButtonLabel:"Yes",submitButtonAltLabel:"Deleting..."});g.setEventListeners();const S=(e,t)=>{const n=new class{constructor(e,t){let{name:n,link:s,id:i,likes:r,ownerId:o,templateSelector:a,handleCardClick:l,handleDeleteCard:_,handleLikeClick:c}=e;var h,u;u=()=>this._likes.some((e=>e._id===this._userId)),(h="_isLiked")in this?Object.defineProperty(this,h,{value:u,enumerable:!0,configurable:!0,writable:!0}):this[h]=u,this._imageTitle=n,this._imageUrl=s,this._id=i,this._likes=r,this._ownerId=o,this._templateSelector=a,this._handleCardClick=l,this._handleDeleteCard=_,this._handleLikeClick=c,this._userId=t}_getTemplate(){this._element=document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_defineElementVariables(){this._elementImage=this._element.querySelector(".element__image"),this._elementButtonDelete=this._element.querySelector(".element__button_action_delete"),this._elementTitle=this._element.querySelector(".element__title"),this._likeCounter=this._element.querySelector(".element__like-counter"),this.elementButtonLike=this._element.querySelector(".element__button_action_like")}_setEventListeners(){this._elementImage.addEventListener("click",(()=>{this._handleCardClick(this._imageTitle,this._imageUrl)})),this._elementButtonDelete.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this.elementButtonLike.addEventListener("click",(()=>{this._handleLikeClick(this._id)}))}_hideDeleteButton(){this._userId!==this._ownerId&&this._elementButtonDelete.classList.add("element__button_inactive")}_updateLikesCount(e){this._likeCounter.textContent=e}_renderLikes(){this._updateLikesCount(this._likes.length),this._isLiked()?this._setLikeIconActive():this._setLikeIconInactive()}updateLikes(e){this._likes=e,this._renderLikes()}_setLikeIconActive(){this.elementButtonLike.classList.add("element__button_action_like_active")}_setLikeIconInactive(){this.elementButtonLike.classList.remove("element__button_action_like_active")}generateCard(){return this._getTemplate(),this._defineElementVariables(),this._hideDeleteButton(),this._setEventListeners(),this._renderLikes(),this._elementImage.src=this._imageUrl,this._elementTitle.textContent=this._imageTitle,this._elementImage.alt=this._imageTitle,this._element}removeElement(){this._element.remove(),this._element=null}}({name:e.name,link:e.link,id:e._id,likes:e.likes,ownerId:e.owner._id,templateSelector:"#template-element",handleCardClick:(e,t)=>{L.open(e,t)},handleDeleteCard:e=>{g.open(),g.setSubmitHandler((()=>{g.showLoading(),h.removeCard(e).then((()=>{n.removeElement(),g.close()})).catch((e=>console.log("Error:     ".concat(e)))).finally((()=>g.hideLoading()))}))},handleLikeClick:e=>{n.elementButtonLike.classList.contains("element__button_action_like_active")?h.removeLike(e).then((e=>{n.updateLikes(e.likes)})).catch((e=>console.log(e))):h.addLike(e).then((e=>{n.updateLikes(e.likes)})).catch((e=>console.log(e)))}},t);return n.generateCard()},E=new t(".popup_content_edit-profile",{submitButtonLabel:s,submitButtonAltLabel:i},((e,t)=>(t.showLoading(),h.setUserData({name:e.name,about:e.job}).then((e=>{b.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),t.close()})).catch((e=>console.log("Error:     ".concat(e)))).finally((()=>{t.hideLoading()}))))),k=new t(".popup_content_edit-avatar",{submitButtonLabel:s,submitButtonAltLabel:i},((e,t)=>(t.showLoading(),h.setUserAvatar(e.link).then((e=>{b.setUserInfo({name:e.name,job:e.about,avatar:e.avatar}),t.close()})).catch((e=>console.log("Error:     ".concat(e)))).finally((()=>{t.hideLoading()})))));var f;h.setup(),h.getInitialData().then((e=>{let[n,s]=e;b.setUserInfo({name:n.name,job:n.about,avatar:n.avatar});const i=new class{constructor(e,t){let{items:n,renderer:s}=e;this._items=n,this._renderer=s,this._section=document.querySelector(t)}addItem(e){this._section.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:s,renderer:e=>{const t=S(e,n._id);i.addItem(t)}},".elements");i.renderItems(),c=n._id;const r=new t(".popup_content_add-card",{submitButtonLabel:"Create",submitButtonAltLabel:"Creating..."},((e,t)=>{t.showLoading(),h.addNewCard({name:e.title,link:e.link}).then((e=>{const n=S(e,c);i.addItem(n),t.close()})).catch((e=>{console.log("Error:     ".concat(e))})).finally((()=>{t.hideLoading()}))}));r.setEventListeners(),d.addEventListener("click",(()=>{_.reset(),v[_.getAttribute("name")].resetInputValidation(),r.open()}))})).catch((e=>console.log("Error:     ".concat(e)))),L.setEventListeners(),E.setEventListeners(),k.setEventListeners(),f={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(f.formSelector)).forEach((e=>{const t=new class{constructor(e,t){this._formElement=t,this._settings=e}_getErrorElement(e){return this._formElement.querySelector("#".concat(e.id,"-error"))}_showInputError(e,t){e.classList.add(this._settings.inputErrorClass),t.classList.add(this._settings.errorClass),t.textContent=e.validationMessage}_hideInputError(e,t){e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_checkInputValidity(e){const t=this._getErrorElement(e);e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_clearInputErrors(){this._inputList.forEach((e=>{this._hideInputError(e,this._getErrorElement(e))}))}_disableButtonSubmit(){this._buttonSubmit.classList.add(this._settings.inactiveButtonClass),this._buttonSubmit.disabled=!0}_enableButtonSubmit(){this._buttonSubmit.classList.remove(this._settings.inactiveButtonClass),this._buttonSubmit.disabled=!1}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this._disableButtonSubmit():this._enableButtonSubmit()}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonSubmit=this._formElement.querySelector(this._settings.submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetInputValidation(){this._clearInputErrors(),this._disableButtonSubmit()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}(f,e),n=e.getAttribute("name");v[n]=t,t.enableValidation()})),m.addEventListener("click",(()=>{(()=>{const e=b.getUserInfo();o.value=e.name,a.value=e.job})(),v[r.getAttribute("name")].resetInputValidation(),E.open()})),p.addEventListener("click",(()=>{v[l.getAttribute("name")].resetInputValidation(),k.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxJQUN2QkEsRUFBYXhCLGlCQUFpQixTQUFTLEtBQ3JDVixLQUFLK00sb0JBQW9CN0ssR0FDekJsQyxLQUFLd04sMkJBS1g1Qix1QkFDRTVMLEtBQUtrTixvQkFDTGxOLEtBQUtvTix1QkFHUEssbUJBQ0V6TixLQUFLd00sYUFBYTlMLGlCQUFpQixVQUFXSSxJQUM1Q0EsRUFBSXdCLG9CQUVOdEMsS0FBSytJLHVCSjlCK0J3QixFQUFvQjhCLEdBQ2xEcUIsRUFBV3JCLEVBQVlWLGFBQWEsUUFFMUM3RSxFQUFlNEcsR0FBWXBCLEVBQzNCQSxFQUFVbUIsc0JBNk1kOUgsRUFBZWpGLGlCQUFpQixTQTlFRixLQU5OLE1BQ3RCLE1BQU1pTixFQUFPN0gsRUFBU08sY0FDdEJqRCxFQUF5QmhCLE1BQVF1TCxFQUFLeEwsS0FDdENrQixFQUF3QmpCLE1BQVF1TCxFQUFLckgsS0FJckNzSCxHQUNBOUcsRUFBZTNELEVBQWdCd0ksYUFBYSxTQUFTQyx1QkFDckQzQixFQUFpQjFKLFVBNEVuQnNGLEVBQXFCbkYsaUJBQWlCLFNBekVULEtBQzNCb0csRUFBZXhELEVBQWVxSSxhQUFhLFNBQVNDLHVCQUNwRHZCLEVBQWdCOUosVSIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2plY3Q4Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0OC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3Byb2plY3Q4Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0OC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdDgvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3Byb2plY3Q4Ly4vc3JjL3BhZ2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJvamVjdDgvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0OC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3Byb2plY3Q4Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0OC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlY3Rpb25TZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9zZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWN0aW9uU2VsZWN0b3IpO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fc2VjdGlvbi5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX2VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2J1dHRvbkNsb3NlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b24tY2xvc2VcIik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5fYnV0dG9uQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwb3B1cFNlbGVjdG9yLFxuICAgIHsgc3VibWl0QnV0dG9uTGFiZWwsIHN1Ym1pdEJ1dHRvbkFsdExhYmVsIH0sXG4gICAgaGFuZGxlRm9ybVN1Ym1pdFxuICApIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b24tc3VibWl0XCIpO1xuICAgIHRoaXMuX2J1dHRvblN1Ym1pdExhYmVsID0gc3VibWl0QnV0dG9uTGFiZWw7XG4gICAgdGhpcy5fYnV0dG9uU3VibWl0QWx0TGFiZWwgPSBzdWJtaXRCdXR0b25BbHRMYWJlbDtcbiAgICB0aGlzLl9idXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSBzdWJtaXRCdXR0b25MYWJlbDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpXTtcblxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0RWxlbWVudC5uYW1lXSA9IGlucHV0RWxlbWVudC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldFN1Ym1pdEhhbmRsZXIoaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpLCB0aGlzKTtcbiAgICB9KTtcblxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzaG93TG9hZGluZygpIHtcbiAgICB0aGlzLl9idXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25TdWJtaXRBbHRMYWJlbDtcbiAgfVxuXG4gIGhpZGVMb2FkaW5nKCkge1xuICAgIHRoaXMuX2J1dHRvblN1Ym1pdC50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblN1Ym1pdExhYmVsO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcbiIsImNvbnN0IHByb2Nlc3NSZXNwb25zZSA9IChyZXMpID0+IHtcbiAgcmV0dXJuIHJlcy5va1xuICAgID8gcmVzLmpzb24oKVxuICAgIDogUHJvbWlzZS5yZWplY3QoYCR7cmVzLnN0YXR1c30gJHtyZXMuc3RhdHVzVGV4dH1gKTtcbn07XG5cbmNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgc2VydmVyVXJsLCBncm91cElkLCB0b2tlbiB9KSB7XG4gICAgdGhpcy5fc2VydmVyVXJsID0gc2VydmVyVXJsO1xuICAgIHRoaXMuX2dyb3VwSWQgPSBncm91cElkO1xuICAgIHRoaXMuX3Rva2VuID0gdG9rZW47XG4gIH1cblxuICBzZXR1cCgpIHtcbiAgICB0aGlzLl9tYWluVXJsID0gYCR7dGhpcy5fc2VydmVyVXJsfS92MS8ke3RoaXMuX2dyb3VwSWR9YDtcbiAgICB0aGlzLl9oZWFkZXJzID0ge1xuICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICB9O1xuICB9XG5cbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9tYWluVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbihwcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckRhdGEoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX21haW5Vcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHByb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9tYWluVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4ocHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX21haW5Vcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbihwcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgc2V0VXNlckRhdGEoeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX21haW5Vcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHByb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhckxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fbWFpblVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGF2YXRhckxpbmsgfSksXG4gICAgfSkudGhlbihwcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fbWFpblVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHByb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHNEYXRhKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9tYWluVXJsfS9jYXJkc2AsIHsgaGVhZGVyczogdGhpcy5faGVhZGVycyB9KS50aGVuKFxuICAgICAgcHJvY2Vzc1Jlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIGdldEluaXRpYWxEYXRhKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VyRGF0YSgpLCB0aGlzLmdldEluaXRpYWxDYXJkc0RhdGEoKV0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCB1c2VySW5mb1NlbGVjdG9ycyA9IHtcbiAgbmFtZXNlbGVjdG9yOiBcIi5wcm9maWxlLWluZm9fX25hbWVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGUtaW5mb19fam9iXCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5hdmF0YXJcIixcbn07XG5cbmNvbnN0IGNhcmRTZWN0aW9uU2VsZWN0b3IgPSBcIi5lbGVtZW50c1wiO1xuXG5jb25zdCBwb3B1cFNlbGVjdG9ycyA9IHtcbiAgcG9wdXBFZGl0UHJvZmlsZTogXCIucG9wdXBfY29udGVudF9lZGl0LXByb2ZpbGVcIixcbiAgcG9wdXBBZGRDYXJkOiBcIi5wb3B1cF9jb250ZW50X2FkZC1jYXJkXCIsXG4gIHBvcHVwV2l0aEltYWdlOiBcIi5wb3B1cF9jb250ZW50X2ltYWdlXCIsXG4gIHBvcHVwRWRpdEF2YXRhcjogXCIucG9wdXBfY29udGVudF9lZGl0LWF2YXRhclwiLFxuICBwb3B1cENvbmZpcm06IFwiLnBvcHVwX2NvbnRlbnRfY29uZmlybWF0aW9uXCIsXG59O1xuXG5jb25zdCBwb3B1cEZvcm1TYXZlQnV0dG9uTGFiZWxzID0ge1xuICBzdWJtaXRCdXR0b25MYWJlbDogXCJTYXZlXCIsXG4gIHN1Ym1pdEJ1dHRvbkFsdExhYmVsOiBcIlNhdmluZy4uLlwiLFxufTtcblxuY29uc3QgcG9wdXBGb3JtRGVsZXRlQnV0dG9uTGFiZWxzID0ge1xuICBzdWJtaXRCdXR0b25MYWJlbDogXCJZZXNcIixcbiAgc3VibWl0QnV0dG9uQWx0TGFiZWw6IFwiRGVsZXRpbmcuLi5cIixcbn07XG5cbmNvbnN0IHBvcHVwRm9ybUNyZWF0ZUJ1dHRvbkxhYmVscyA9IHtcbiAgc3VibWl0QnV0dG9uTGFiZWw6IFwiQ3JlYXRlXCIsXG4gIHN1Ym1pdEJ1dHRvbkFsdExhYmVsOiBcIkNyZWF0aW5nLi4uXCIsXG59O1xuXG5jb25zdCBlZGl0UHJvZmlsZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19jb250YWluZXJfY29udGVudF9lZGl0LXByb2ZpbGVcIlxuKTtcbmNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IGVkaXRQcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbmNvbnN0IGZvcm1FZGl0UHJvZmlsZUlucHV0TmFtZSA9IGZvcm1FZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxuICBcIi5mb3JtX19pbnB1dF90eXBlX25hbWVcIlxuKTtcbmNvbnN0IGZvcm1FZGl0UHJvZmlsZUlucHV0Sm9iID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmZvcm1fX2lucHV0X3R5cGVfam9iXCJcbik7XG5cbmNvbnN0IGVkaXRBdmF0YXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9jb250ZW50X2VkaXQtYXZhdGFyXCJcbik7XG5jb25zdCBmb3JtRWRpdEF2YXRhciA9IGVkaXRBdmF0YXJDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuY29uc3QgZm9ybUVkaXRBdmF0YXJJbnB1dExpbmsgPSBmb3JtRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKFxuICBcIi5mb3JtX19pbnB1dF90eXBlX2xpbmtcIlxuKTtcblxuY29uc3QgYWRkQ2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19jb250YWluZXJfY29udGVudF9hZGQtY2FyZFwiXG4pO1xuY29uc3QgZm9ybUFkZENhcmQgPSBhZGRDYXJkQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcblxuY29uc3QgYXBpU2V0dGluZ3MgPSB7XG4gIHNlcnZlclVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvXCIsXG4gIGdyb3VwSWQ6IFwiZ3JvdXAtMTJcIixcbiAgdG9rZW46IFwiNjUyNTQxZGItM2FjOS00YzZjLTk4OTUtMzlhYjJhZTRjOWYzXCIsXG59O1xuXG5leHBvcnQge1xuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHVzZXJJbmZvU2VsZWN0b3JzLFxuICBwb3B1cFNlbGVjdG9ycyxcbiAgY2FyZFNlY3Rpb25TZWxlY3RvcixcbiAgZm9ybUVkaXRQcm9maWxlLFxuICBmb3JtQWRkQ2FyZCxcbiAgZm9ybUVkaXRQcm9maWxlSW5wdXROYW1lLFxuICBmb3JtRWRpdFByb2ZpbGVJbnB1dEpvYixcbiAgZm9ybUVkaXRBdmF0YXIsXG4gIGZvcm1FZGl0QXZhdGFySW5wdXRMaW5rLFxuICBhcGlTZXR0aW5ncyxcbiAgcG9wdXBGb3JtU2F2ZUJ1dHRvbkxhYmVscyxcbiAgcG9wdXBGb3JtRGVsZXRlQnV0dG9uTGFiZWxzLFxuICBwb3B1cEZvcm1DcmVhdGVCdXR0b25MYWJlbHMsXG59O1xuIiwiaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpXCI7XG5cbmltcG9ydCB7XG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgdXNlckluZm9TZWxlY3RvcnMsXG4gIHBvcHVwU2VsZWN0b3JzLFxuICBjYXJkU2VjdGlvblNlbGVjdG9yLFxuICBmb3JtRWRpdFByb2ZpbGUsXG4gIGZvcm1BZGRDYXJkLFxuICBmb3JtRWRpdFByb2ZpbGVJbnB1dE5hbWUsXG4gIGZvcm1FZGl0UHJvZmlsZUlucHV0Sm9iLFxuICBmb3JtRWRpdEF2YXRhcixcbiAgZm9ybUVkaXRBdmF0YXJJbnB1dExpbmssXG4gIGFwaVNldHRpbmdzLFxuICBwb3B1cEZvcm1TYXZlQnV0dG9uTGFiZWxzLFxuICBwb3B1cEZvcm1EZWxldGVCdXR0b25MYWJlbHMsXG4gIHBvcHVwRm9ybUNyZWF0ZUJ1dHRvbkxhYmVscyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5sZXQgdXNlcklkID0gXCJcIjtcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBzZXJ2ZXJVcmw6IGFwaVNldHRpbmdzLnNlcnZlclVybCxcbiAgZ3JvdXBJZDogYXBpU2V0dGluZ3MuZ3JvdXBJZCxcbiAgdG9rZW46IGFwaVNldHRpbmdzLnRva2VuLFxufSk7XG5cbmNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XG5cbmNvbnN0IHByb2ZpbGVFZGl0QnRuID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtaW5mb19fYnV0dG9uLWVkaXRcIik7XG5jb25zdCBwcm9maWxlQWRkQnRuID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvbi1hZGRcIik7XG5cbmNvbnN0IHByb2ZpbGVFZGl0QXZhdGFyQnRuID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLmF2YXRhclwiKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IHVzZXJJbmZvU2VsZWN0b3JzLm5hbWVzZWxlY3RvcixcbiAgam9iU2VsZWN0b3I6IHVzZXJJbmZvU2VsZWN0b3JzLmpvYlNlbGVjdG9yLFxuICBhdmF0YXJTZWxlY3RvcjogdXNlckluZm9TZWxlY3RvcnMuYXZhdGFyU2VsZWN0b3IsXG59KTtcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBTZWxlY3RvcnMucG9wdXBXaXRoSW1hZ2UpO1xuXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uU2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxuICApO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZm9ybUVsZW1lbnQpO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmNvbnN0IHBvcHVwQ29uZmlybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwU2VsZWN0b3JzLnBvcHVwQ29uZmlybSwge1xuICBzdWJtaXRCdXR0b25MYWJlbDogcG9wdXBGb3JtRGVsZXRlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkxhYmVsLFxuICBzdWJtaXRCdXR0b25BbHRMYWJlbDogcG9wdXBGb3JtRGVsZXRlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkFsdExhYmVsLFxufSk7XG5wb3B1cENvbmZpcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkRGF0YSwgdXNlcklkKSA9PiB7XG4gIGNvbnN0IG5ld0NhcmRPYmplY3QgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxuICAgICAgbGluazogY2FyZERhdGEubGluayxcbiAgICAgIGlkOiBjYXJkRGF0YS5faWQsXG4gICAgICBsaWtlczogY2FyZERhdGEubGlrZXMsXG4gICAgICBvd25lcklkOiBjYXJkRGF0YS5vd25lci5faWQsXG4gICAgICB0ZW1wbGF0ZVNlbGVjdG9yOiBcIiN0ZW1wbGF0ZS1lbGVtZW50XCIsXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6IChuYW1lLCBsaW5rKSA9PiB7XG4gICAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4obmFtZSwgbGluayk7XG4gICAgICB9LFxuICAgICAgaGFuZGxlRGVsZXRlQ2FyZDogKGlkKSA9PiB7XG4gICAgICAgIHBvcHVwQ29uZmlybS5vcGVuKCk7XG4gICAgICAgIHBvcHVwQ29uZmlybS5zZXRTdWJtaXRIYW5kbGVyKCgpID0+IHtcbiAgICAgICAgICBwb3B1cENvbmZpcm0uc2hvd0xvYWRpbmcoKTtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5yZW1vdmVDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBuZXdDYXJkT2JqZWN0LnJlbW92ZUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgcG9wdXBDb25maXJtLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvcjogICAgICR7ZXJyfWApKVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gcG9wdXBDb25maXJtLmhpZGVMb2FkaW5nKCkpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2xpY2s6IChpZCkgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgbmV3Q2FyZE9iamVjdC5lbGVtZW50QnV0dG9uTGlrZS5jbGFzc0xpc3QuY29udGFpbnMoXG4gICAgICAgICAgICBcImVsZW1lbnRfX2J1dHRvbl9hY3Rpb25fbGlrZV9hY3RpdmVcIlxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgYXBpXG4gICAgICAgICAgICAucmVtb3ZlTGlrZShpZClcbiAgICAgICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgICAgICBuZXdDYXJkT2JqZWN0LnVwZGF0ZUxpa2VzKGNhcmREYXRhLmxpa2VzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXBpXG4gICAgICAgICAgICAuYWRkTGlrZShpZClcbiAgICAgICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgICAgICBuZXdDYXJkT2JqZWN0LnVwZGF0ZUxpa2VzKGNhcmREYXRhLmxpa2VzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSxcbiAgICB1c2VySWRcbiAgKTtcblxuICByZXR1cm4gbmV3Q2FyZE9iamVjdC5nZW5lcmF0ZUNhcmQoKTtcbn07XG5cbmNvbnN0IGhhbmRsZUVkaXRQcm9maWxlRm9ybVN1Ym1pdCA9IChmb3JtSW5wdXRWYWx1ZXMsIGVkaXRQcm9maWxlRm9ybSkgPT4ge1xuICBlZGl0UHJvZmlsZUZvcm0uc2hvd0xvYWRpbmcoKTtcbiAgcmV0dXJuIGFwaVxuICAgIC5zZXRVc2VyRGF0YSh7XG4gICAgICBuYW1lOiBmb3JtSW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgIGFib3V0OiBmb3JtSW5wdXRWYWx1ZXMuam9iLFxuICAgIH0pXG4gICAgLnRoZW4oKHVzZXJEYXRhUmVzcG9uc2UpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZTogdXNlckRhdGFSZXNwb25zZS5uYW1lLFxuICAgICAgICBqb2I6IHVzZXJEYXRhUmVzcG9uc2UuYWJvdXQsXG4gICAgICAgIGF2YXRhcjogdXNlckRhdGFSZXNwb25zZS5hdmF0YXIsXG4gICAgICB9KTtcbiAgICAgIGVkaXRQcm9maWxlRm9ybS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvcjogICAgICR7ZXJyfWApKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlRm9ybS5oaWRlTG9hZGluZygpO1xuICAgIH0pO1xufTtcblxuY29uc3QgaGFuZGxlRWRpdEF2YXRhckZvcm1TdWJtaXQgPSAoZm9ybUlucHV0VmFsdWVzLCBlZGl0QXZhdGFyRm9ybSkgPT4ge1xuICBlZGl0QXZhdGFyRm9ybS5zaG93TG9hZGluZygpO1xuICByZXR1cm4gYXBpXG4gICAgLnNldFVzZXJBdmF0YXIoZm9ybUlucHV0VmFsdWVzLmxpbmspXG4gICAgLnRoZW4oKHVzZXJEYXRhUmVzcG9uc2UpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZTogdXNlckRhdGFSZXNwb25zZS5uYW1lLFxuICAgICAgICBqb2I6IHVzZXJEYXRhUmVzcG9uc2UuYWJvdXQsXG4gICAgICAgIGF2YXRhcjogdXNlckRhdGFSZXNwb25zZS5hdmF0YXIsXG4gICAgICB9KTtcbiAgICAgIGVkaXRBdmF0YXJGb3JtLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yOiAgICAgJHtlcnJ9YCkpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhckZvcm0uaGlkZUxvYWRpbmcoKTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgcG9wdXBTZWxlY3RvcnMucG9wdXBFZGl0UHJvZmlsZSxcbiAge1xuICAgIHN1Ym1pdEJ1dHRvbkxhYmVsOiBwb3B1cEZvcm1TYXZlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkxhYmVsLFxuICAgIHN1Ym1pdEJ1dHRvbkFsdExhYmVsOiBwb3B1cEZvcm1TYXZlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkFsdExhYmVsLFxuICB9LFxuICBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXRcbik7XG5cbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBwb3B1cFNlbGVjdG9ycy5wb3B1cEVkaXRBdmF0YXIsXG4gIHtcbiAgICBzdWJtaXRCdXR0b25MYWJlbDogcG9wdXBGb3JtU2F2ZUJ1dHRvbkxhYmVscy5zdWJtaXRCdXR0b25MYWJlbCxcbiAgICBzdWJtaXRCdXR0b25BbHRMYWJlbDogcG9wdXBGb3JtU2F2ZUJ1dHRvbkxhYmVscy5zdWJtaXRCdXR0b25BbHRMYWJlbCxcbiAgfSxcbiAgaGFuZGxlRWRpdEF2YXRhckZvcm1TdWJtaXRcbik7XG5cbmNvbnN0IGZpbGxQcm9maWxlRm9ybSA9ICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGZvcm1FZGl0UHJvZmlsZUlucHV0TmFtZS52YWx1ZSA9IGluZm8ubmFtZTtcbiAgZm9ybUVkaXRQcm9maWxlSW5wdXRKb2IudmFsdWUgPSBpbmZvLmpvYjtcbn07XG5cbmNvbnN0IGhhbmRsZUVkaXRQcm9maWxlT3BlbiA9ICgpID0+IHtcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm1FZGl0UHJvZmlsZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldElucHV0VmFsaWRhdGlvbigpO1xuICBwb3B1cEVkaXRQcm9maWxlLm9wZW4oKTtcbn07XG5cbmNvbnN0IGhhbmRsZUVkaXRBdmF0YXJPcGVuID0gKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tmb3JtRWRpdEF2YXRhci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldElucHV0VmFsaWRhdGlvbigpO1xuICBwb3B1cEVkaXRBdmF0YXIub3BlbigpO1xufTtcblxuYXBpLnNldHVwKCk7XG5hcGlcbiAgLmdldEluaXRpYWxEYXRhKClcbiAgLnRoZW4oKFt1c2VyRGF0YSwgaW5pdGlhbENhcmRzRGF0YV0pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgam9iOiB1c2VyRGF0YS5hYm91dCxcbiAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxuICAgIH0pO1xuICAgIGNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHNEYXRhLFxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSwgdXNlckRhdGEuX2lkKTtcbiAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkU2VjdGlvblNlbGVjdG9yXG4gICAgKTtcblxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuXG4gICAgY29uc3QgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQgPSAoZGF0YSwgYWRkQ2FyZEZvcm0pID0+IHtcbiAgICAgIGFkZENhcmRGb3JtLnNob3dMb2FkaW5nKCk7XG4gICAgICBhcGlcbiAgICAgICAgLmFkZE5ld0NhcmQoeyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLmxpbmsgfSlcbiAgICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEsIHVzZXJJZCk7XG4gICAgICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICAgICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogICAgICR7ZXJyfWApO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgYWRkQ2FyZEZvcm0uaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgcG9wdXBTZWxlY3RvcnMucG9wdXBBZGRDYXJkLFxuICAgICAge1xuICAgICAgICBzdWJtaXRCdXR0b25MYWJlbDogcG9wdXBGb3JtQ3JlYXRlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkxhYmVsLFxuICAgICAgICBzdWJtaXRCdXR0b25BbHRMYWJlbDogcG9wdXBGb3JtQ3JlYXRlQnV0dG9uTGFiZWxzLnN1Ym1pdEJ1dHRvbkFsdExhYmVsLFxuICAgICAgfSxcbiAgICAgIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XG4gICAgKTtcblxuICAgIGNvbnN0IGhhbmRsZUFkZENhcmRGb3JtT3BlbiA9ICgpID0+IHtcbiAgICAgIGZvcm1BZGRDYXJkLnJlc2V0KCk7XG4gICAgICBmb3JtVmFsaWRhdG9yc1tmb3JtQWRkQ2FyZC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldElucHV0VmFsaWRhdGlvbigpO1xuICAgICAgcG9wdXBBZGRDYXJkLm9wZW4oKTtcbiAgICB9O1xuXG4gICAgcG9wdXBBZGRDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBwcm9maWxlQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBZGRDYXJkRm9ybU9wZW4pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yOiAgICAgJHtlcnJ9YCkpO1xuXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBFZGl0QXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcblxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRQcm9maWxlT3Blbik7XG5wcm9maWxlRWRpdEF2YXRhckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEF2YXRhck9wZW4pO1xuIiwiY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgbmFtZSA9IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50O1xuICAgIGNvbnN0IGpvYiA9IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgY29uc3QgYXZhdGFyID0gdGhpcy5fYXZhdGFyRWxlbWVudC5zcmM7XG4gICAgY29uc3QgdXNlckluZm8gPSB7IG5hbWU6IG5hbWUsIGpvYjogam9iLCBhdmF0YXI6IGF2YXRhciB9O1xuXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtdGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHRpdGxlLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9pbWFnZVRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aXRsZTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7XG4gICAgICBuYW1lLFxuICAgICAgbGluayxcbiAgICAgIGlkLFxuICAgICAgbGlrZXMsXG4gICAgICBvd25lcklkLFxuICAgICAgdGVtcGxhdGVTZWxlY3RvcixcbiAgICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICAgIGhhbmRsZURlbGV0ZUNhcmQsXG4gICAgICBoYW5kbGVMaWtlQ2xpY2ssXG4gICAgfSxcbiAgICB1c2VySWRcbiAgKSB7XG4gICAgdGhpcy5faW1hZ2VUaXRsZSA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2VVcmwgPSBsaW5rO1xuICAgIHRoaXMuX2lkID0gaWQ7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLl9vd25lcklkID0gb3duZXJJZDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfZGVmaW5lRWxlbWVudFZhcmlhYmxlcygpIHtcbiAgICB0aGlzLl9lbGVtZW50SW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XG4gICAgdGhpcy5fZWxlbWVudEJ1dHRvbkRlbGV0ZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmVsZW1lbnRfX2J1dHRvbl9hY3Rpb25fZGVsZXRlXCJcbiAgICApO1xuICAgIHRoaXMuX2VsZW1lbnRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190aXRsZVwiKTtcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlLWNvdW50ZXJcIik7XG4gICAgdGhpcy5lbGVtZW50QnV0dG9uTGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmVsZW1lbnRfX2J1dHRvbl9hY3Rpb25fbGlrZVwiXG4gICAgKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9pbWFnZVRpdGxlLCB0aGlzLl9pbWFnZVVybCk7XG4gICAgfSk7XG4gICAgdGhpcy5fZWxlbWVudEJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCk7XG4gICAgfSk7XG4gICAgdGhpcy5lbGVtZW50QnV0dG9uTGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuX2lkKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oaWRlRGVsZXRlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnRCdXR0b25EZWxldGUuY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX2J1dHRvbl9pbmFjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBfdXBkYXRlTGlrZXNDb3VudChjb3VudCkge1xuICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gY291bnQ7XG4gIH1cblxuICBfaXNMaWtlZCA9ICgpID0+IHRoaXMuX2xpa2VzLnNvbWUoKGVudHJ5KSA9PiBlbnRyeS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIHRoaXMuX3VwZGF0ZUxpa2VzQ291bnQodGhpcy5fbGlrZXMubGVuZ3RoKTtcblxuICAgIGlmICh0aGlzLl9pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMuX3NldExpa2VJY29uQWN0aXZlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NldExpa2VJY29uSW5hY3RpdmUoKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9zZXRMaWtlSWNvbkFjdGl2ZSgpIHtcbiAgICB0aGlzLmVsZW1lbnRCdXR0b25MaWtlLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19idXR0b25fYWN0aW9uX2xpa2VfYWN0aXZlXCIpO1xuICB9XG5cbiAgX3NldExpa2VJY29uSW5hY3RpdmUoKSB7XG4gICAgdGhpcy5lbGVtZW50QnV0dG9uTGlrZS5jbGFzc0xpc3QucmVtb3ZlKFxuICAgICAgXCJlbGVtZW50X19idXR0b25fYWN0aW9uX2xpa2VfYWN0aXZlXCJcbiAgICApO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fZGVmaW5lRWxlbWVudFZhcmlhYmxlcygpO1xuICAgIHRoaXMuX2hpZGVEZWxldGVCdXR0b24oKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgdGhpcy5fZWxlbWVudEltYWdlLnNyYyA9IHRoaXMuX2ltYWdlVXJsO1xuICAgIHRoaXMuX2VsZW1lbnRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX2ltYWdlVGl0bGU7XG4gICAgdGhpcy5fZWxlbWVudEltYWdlLmFsdCA9IHRoaXMuX2ltYWdlVGl0bGU7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICByZW1vdmVFbGVtZW50KCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgfVxyXG5cclxuICBfZ2V0RXJyb3JFbGVtZW50KGlucHV0RWxlbWVudCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yRWxlbWVudCkge1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JFbGVtZW50KSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpO1xyXG5cclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jbGVhcklucHV0RXJyb3JzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIHRoaXMuX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b25TdWJtaXQoKSB7XHJcbiAgICB0aGlzLl9idXR0b25TdWJtaXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uU3VibWl0KCkge1xyXG4gICAgdGhpcy5fYnV0dG9uU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25TdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b25TdWJtaXQoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvblN1Ym1pdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlc2V0SW5wdXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fY2xlYXJJbnB1dEVycm9ycygpO1xyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvblN1Ym1pdCgpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX2VsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfYnV0dG9uQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VibWl0QnV0dG9uTGFiZWwiLCJzdWJtaXRCdXR0b25BbHRMYWJlbCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9idXR0b25TdWJtaXQiLCJfYnV0dG9uU3VibWl0TGFiZWwiLCJfYnV0dG9uU3VibWl0QWx0TGFiZWwiLCJ0ZXh0Q29udGVudCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJuYW1lIiwidmFsdWUiLCJzZXRTdWJtaXRIYW5kbGVyIiwicHJldmVudERlZmF1bHQiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwicmVzZXQiLCJwcm9jZXNzUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsInBvcHVwRm9ybVNhdmVCdXR0b25MYWJlbHMiLCJmb3JtRWRpdFByb2ZpbGUiLCJmb3JtRWRpdFByb2ZpbGVJbnB1dE5hbWUiLCJmb3JtRWRpdFByb2ZpbGVJbnB1dEpvYiIsImZvcm1FZGl0QXZhdGFyIiwiZm9ybUFkZENhcmQiLCJ1c2VySWQiLCJhcGkiLCJzZXJ2ZXJVcmwiLCJncm91cElkIiwidG9rZW4iLCJfc2VydmVyVXJsIiwiX2dyb3VwSWQiLCJfdG9rZW4iLCJzZXR1cCIsIl9tYWluVXJsIiwiX2hlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiYWRkTmV3Q2FyZCIsImxpbmsiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJnZXRVc2VyRGF0YSIsInJlbW92ZUxpa2UiLCJjYXJkSWQiLCJhZGRMaWtlIiwic2V0VXNlckRhdGEiLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXJMaW5rIiwiYXZhdGFyIiwicmVtb3ZlQ2FyZCIsImdldEluaXRpYWxDYXJkc0RhdGEiLCJnZXRJbml0aWFsRGF0YSIsImFsbCIsInByb2ZpbGUiLCJwcm9maWxlRWRpdEJ0biIsInByb2ZpbGVBZGRCdG4iLCJwcm9maWxlRWRpdEF2YXRhckJ0biIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNyYyIsInNldFVzZXJJbmZvIiwicG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfaW1hZ2VUaXRsZSIsInRpdGxlIiwiYWx0IiwiZm9ybVZhbGlkYXRvcnMiLCJwb3B1cENvbmZpcm0iLCJQb3B1cFdpdGhGb3JtIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwibmV3Q2FyZE9iamVjdCIsImlkIiwibGlrZXMiLCJvd25lcklkIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQ2xpY2siLCJfbGlrZXMiLCJzb21lIiwiZW50cnkiLCJfaWQiLCJfdXNlcklkIiwiX2ltYWdlVXJsIiwiX293bmVySWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2RlZmluZUVsZW1lbnRWYXJpYWJsZXMiLCJfZWxlbWVudEltYWdlIiwiX2VsZW1lbnRCdXR0b25EZWxldGUiLCJfZWxlbWVudFRpdGxlIiwiX2xpa2VDb3VudGVyIiwiZWxlbWVudEJ1dHRvbkxpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaGlkZURlbGV0ZUJ1dHRvbiIsIl91cGRhdGVMaWtlc0NvdW50IiwiY291bnQiLCJfcmVuZGVyTGlrZXMiLCJsZW5ndGgiLCJfaXNMaWtlZCIsIl9zZXRMaWtlSWNvbkFjdGl2ZSIsIl9zZXRMaWtlSWNvbkluYWN0aXZlIiwidXBkYXRlTGlrZXMiLCJnZW5lcmF0ZUNhcmQiLCJyZW1vdmVFbGVtZW50Iiwib3duZXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwicG9wdXBFZGl0UHJvZmlsZSIsImZvcm1JbnB1dFZhbHVlcyIsImVkaXRQcm9maWxlRm9ybSIsInVzZXJEYXRhUmVzcG9uc2UiLCJwb3B1cEVkaXRBdmF0YXIiLCJlZGl0QXZhdGFyRm9ybSIsInZhbGlkYXRpb25TZXR0aW5ncyIsInVzZXJEYXRhIiwiaW5pdGlhbENhcmRzRGF0YSIsImNhcmRMaXN0Iiwic2VjdGlvblNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9zZWN0aW9uIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJwb3B1cEFkZENhcmQiLCJkYXRhIiwiYWRkQ2FyZEZvcm0iLCJuZXdDYXJkIiwiZ2V0QXR0cmlidXRlIiwicmVzZXRJbnB1dFZhbGlkYXRpb24iLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwic2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZ2V0RXJyb3JFbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbGVtZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jbGVhcklucHV0RXJyb3JzIiwiX2lucHV0TGlzdCIsIl9kaXNhYmxlQnV0dG9uU3VibWl0IiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uU3VibWl0IiwiX2hhc0ludmFsaWRJbnB1dCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJmb3JtTmFtZSIsImluZm8iLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9